const scheduleEl = document.getElementById("schedule");
const todayDateEl = document.getElementById("todayDate");

const weekdays = [
  "–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ",
  "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",
  "–í—Ç–æ—Ä–Ω–∏–∫",
  "–°—Ä–µ–¥–∞",
  "–ß–µ—Ç–≤–µ—Ä–≥",
  "–ü—è—Ç–Ω–∏—Ü–∞",
  "–°—É–±–±–æ—Ç–∞"
];

// –ë–∞–∑–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ (–ø—Ä–∏–º–µ—Ä)
const baseSchedule = {
  monday: [
    {
      id: 1,
      title: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞",
      start: "09:00",
      end: "10:30",
      color: "#5B8DEF"
    }
  ]
};

// –ò—Å–∫–ª—é—á–µ–Ω–∏—è
const exceptions = [
  {
    date: "2026-02-17",
    lessonId: 1,
    type: "cancel"
  }
];

function getTodayLessons() {
  const now = new Date();
  const dayKey = ["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][now.getDay()];
  let lessons = baseSchedule[dayKey] || [];

  const todayStr = now.toISOString().split("T")[0];

  return lessons.map(lesson => {
    const exception = exceptions.find(
      e => e.date === todayStr && e.lessonId === lesson.id
    );
    return { ...lesson, exception };
  });
}

function render() {
  const now = new Date();
  todayDateEl.textContent = `${weekdays[now.getDay()]}, ${now.toLocaleDateString("ru-RU")}`;

  const lessons = getTodayLessons();
  scheduleEl.innerHTML = "";

  if (lessons.length === 0) {
    scheduleEl.innerHTML = "<p>–°–µ–≥–æ–¥–Ω—è –∑–∞–Ω—è—Ç–∏–π –Ω–µ—Ç üéâ</p>";
    return;
  }

  lessons.forEach(lesson => {
    const div = document.createElement("div");
    div.className = "lesson";

    if (lesson.exception?.type === "cancel") {
      div.classList.add("cancelled");
    }

    div.innerHTML = `
      <div class="color" style="background:${lesson.color}"></div>
      <div class="info">
        <div class="time">${lesson.start} ‚Äì ${lesson.end}</div>
        <div class="title">${lesson.title}</div>
      </div>
    `;

    scheduleEl.appendChild(div);
  });
}

render();